<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Planting Date Decision Support Tool</title>

    <!-- Bootstrap core CSS -->

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

    <!-- Optional theme -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap-theme.min.css" integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous"> -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet"> -->

    <!-- Custom styles for this template -->
    <link href="jumbotron-narrow.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Highcharts Library -->
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/dumbbell.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script src="output.js"></script>

    <style>
    /* modal test */

    #myModal {
    height: 100%;
    width: 100%;
    color: #444;
    cursor: help;
    text-align: left;
    outline: none;
    border-radius: 5px;
    font-size: 15px;
    z-index: 800;
    }

    #myBtn {
    width: 40px;
    height: 40px;
    background-size: 40px 40px;
    color: #444;
    cursor: help;
    text-align: left;
    outline: none;
    border-radius: 5px;
    font-size: 15px;
    }

    .modal {
      display: none; /* Hidden by default */
      position: fixed; /* Stay in place */
      z-index: 1; /* Sit on top */
      padding-top: 20px; /* Location of the box */
      left: 0;
      top: 0;
      width: 100%; /* Full width */
      height: 100%; /* Full height */
      overflow: auto; /* Enable scroll if needed */
      background-color: #005d7e; /* Fallback color */
      background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal Content */
    .modal-content {
      background-color: #fefefe;
      margin: auto;
      padding: 5px;
      font-size: 12px;
      line-height: 15px;
      border: 0px solid #005d7e;
      border-radius: 5px;
      width: 80%;
      height: 80vh !important;
      max-width: 80%;
    }

    .modal-dialog {
        max-width: 80%;
        margin: 0;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
    }

    /* The Close Button */
    .close {
      color: #aaaaaa;
      float: right;
      font-size: 42px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: #000;
      text-decoration: none;
      cursor: pointer;
    }

  </style>

  </head>

  <body>

    <!-- Main Info Modal -->
    <div id="myModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close"></span>
          <iframe src="./UX/index.html" title="Iframe Example" height="100%" width="100%"style="border:none;"></iframe>
      </div>
    </div>

    <div class="container">
      <div class="header clearfix">
        <nav>
          <ul class="nav nav-pills pull-right">
            <li role="presentation" class="active"><a href="#">Home</a></li>
            <li role="presentation"><a href="#">About</a></li>
            <li role="presentation"><a href="#">Contact</a></li>
          </ul>
        </nav>
        <h3 class="text-muted">Planty McPlantface v0.04a</h3>

        <div class="row marketing">
          <div class="col-lg-6">
            <h4><b>What</b> are you planting?</h4>
            <p>
                 <form name="myform" id="myForm">
                     <select name="optone" id="cropSel" size="1">
                         <option value="" selected="selected">Select Crop</option>
                     </select>
                     <br>
                     <select name="opttwo" id="cultivarSel" size="1">
                         <option value="" selected="selected">Please select crop first</option>
                     </select>
                     <br>
                     <br>

                     <h4><b>When</b> are you planting?</h4>
                     <select name="optthree" id="seasonSel" size="1">
                         <option value="" selected="selected">Please select crop & cultivar first</option>
                     </select>
                 </form>
            <br>
            <p>First Day of Harvest &nbsp;<input type="date" id="Hdate1"
                value="2023-05-01"
                min="2023-05-01"
                max="2023-07-15">
            <br>Last Day of Harvest &nbsp;<input type="date" id="Hdate2"
            value="2023-05-01"
            min="2023-05-01"
            max="2023-07-15">
          </p>
          </div>

          <div class="col-lg-6">
            <h4><b>Where</b> are you growing?</h4>
            <p><button id="myBtn"><img src="geoicon.ico" height="40" width="40"></button>&nbsp;&nbsp; click to open weather station map</p>

            <h4><b>How</b> are you growing?</h4>
            <p>
              <select name="prodSys" id="systems">
                <option value="field">Field</option>
                <option value="HT">High Tunnel</option>
                <option value="GH">Greenhouse</option>
              </select> </p>
          </div>
      </div>



      <div class="jumbotron">
        <p class="lead">
             <figure class="highcharts-figure">
                  <div id="container"></div>
                  <!-- <p class="highcharts-description" style="font-size:14px; ">
                       This chart shows a modeled growth of selected plant based on historic growing degree days and recommended maturity (<img src="./UX/icons/maturity-icon.png">) at harvest.
                 </p> -->
           </figure>
      <p><a class="btn btn-lg btn-success" href="#" role="button" onClick="window.location.reload();">Calculate</a></p>
      </div>


      </div>

      <footer class="footer">
        <p>GNU Public License v3</p>
      </footer>

    </div> <!-- /container -->




<script>

     var  locale = 'en-US',
          options = {
               month: 'long',
               day: 'numeric',
               year: 'numeric',
          }

          //pull dates from calendar picker
     var  HarvestDate1 = new Date(document.getElementById("Hdate1").valueAsDate.getTime()),
          HarvestDate2 = new Date(document.getElementById("Hdate2").valueAsDate.getTime()),

          //conversion from Days to Milliseconds
          DaysToMS = 86400000,

          //placeholder data for modeled number of days to maturity
          ModelGrowth1 = 55,
          ModelGrowth2 = 50,

          //back calculate planting days
          PlantDate1 = HarvestDate1 - ModelGrowth1 * DaysToMS,
          PlantDate2 = HarvestDate2 - ModelGrowth2 * DaysToMS


     var data = [{
         name: 'First Planting',
         low: PlantDate1,
         high: HarvestDate1.getTime()
     }, {
         name: 'Last Planting',
         low: PlantDate2,
         high: HarvestDate2.getTime()
     }];

     Highcharts.setOptions({
          symbols:["circle","square","diamond","circle"],
          colors: ['#097969', '#AFE1AF', '#50C878', '#24CBE5', '#64E572', '#FF9655', '#FFF263', '#6AF9C4']
     });

     Highcharts.chart('container', {

         chart: {
             type: 'dumbbell',
             inverted: true,
             styledMode: false
         },

         legend: {
             enabled: false
         },

         subtitle: {
             text: 'modeled with 10 year data from ' +
                 '<a href="https://ec.europa.eu/eurostat/en/web/main/data/database"' +
                 'target="_blank">[KY Mesonet Station Name]</a>'
         },

         title: {
              text: 'Planting and Harvest Interval'
         },

         tooltip: {
             formatter:function(){
                  console.log(this)
                  return '<b>' + this.point.name + ': </b><br> Plant:  <b>' + Highcharts.dateFormat('%B %d', this.point.options.low) + '</b><br/>' + 'Harvest: <b>'+ Highcharts.dateFormat('%B %d', this.point.options.high) + '</b><br/>';
             }
         },

         xAxis: {
             type: 'category'
         },

         yAxis: {
             type: 'datetime',
             labels: {
               formatter: function() {
                 return Highcharts.dateFormat('%B %e', this.value)
               }
             },
             title: {
                 text: 'Day of Year'

             }
         },

         series: [{
             name: 'Planting and Harvest Interval',
             data: data,
             connectorWidth: 8,
             lowColor: '#ff9933',
             marker: {
                radius: 4
             }
         }]


     });

     // info modal code
     var modal = document.getElementById('myModal');
     // Get the button that opens the modal
     var btn = document.getElementById("myBtn");
     // Get the <span> element that closes the modal
     var span = document.getElementsByClassName("close")[0];
     // When the user clicks the button, open the modal
     btn.onclick = function() {
         modal.style.display = "block";
     }
     // When the user clicks on <span> (x), close the modal
     span.onclick = function() {
         modal.style.display = "none";
     }
     // When the user clicks anywhere outside of the modal, close it
     window.onclick = function(event) {
         if (event.target == modal) {
             modal.style.display = "none";
         }
     }


</script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->
  </body>
</html>
